// animated loader (shown only when website is first opened)
'use client';
import { useFlowerLoaderAnimation } from '@/hooks/useFlowerLoaderAnimation';
import { useRef } from 'react';

export default function FlowerLoader({
  setLoading,
}: {
  setLoading: (loading: boolean) => void;
}) {
  const svg1Ref = useRef<SVGSVGElement | null>(null);
  const svg2Ref = useRef<SVGSVGElement | null>(null);
  const circleRef = useRef<SVGPathElement | null>(null);

  const handleAnimationComplete = () => {
    setLoading(false);
  };

  useFlowerLoaderAnimation(
    svg1Ref,
    svg2Ref,
    circleRef,
    handleAnimationComplete
  );

  return (
    <div className='relative flex flex-col items-center justify-center min-h-dvh w-full bg-neutral-900 gap-20'>
      {/* Main Flower (drawn with DrawSVG) */}
      <svg
        ref={svg1Ref}
        width='120'
        height='179'
        viewBox='0 0 120 179'
        fill='none'
        xmlns='http://www.w3.org/2000/svg'
        className='w-[300px] h-[300px]'
      >
        {/* Inline styles for stroke-dasharray (required for DrawSVG) */}
        <style>{`
          path, circle {
            stroke-dasharray: 1000;
            stroke-dashoffset: 1000;
          }
        `}</style>

        {/* Petal 1 */}
        <path
          d='M43.4464 114.664C41.1723 117.369 46.4843 123.612 48.3493 126.539L48.0508 126.807C41.5731 120.87 37.5743 122.08 36.2132 122.182C29.0268 122.716 27.5229 120.266 27.5704 119.261C28.1806 115.635 34.4705 117.42 37.4358 119.019C33.2277 113.918 29.5831 112.448 28.2869 112.35C25.0403 112.062 18.885 110.731 20.2373 107.714C21.5895 104.697 26.9339 107.082 29.4371 108.652C29.3891 106.115 25.4745 101.704 21.8361 101.23C15.6788 100.426 15.0528 99.3293 15.3896 98.2844C16.0649 95.1408 22.1997 96.4563 25.1827 97.5071C20.6447 95.1219 14.503 89.6828 17.7241 87.0675C21.4094 84.0752 25.936 92.227 26.9644 96.4488C27.0168 93.4438 27.8527 87.553 30.7765 88.0303C34.4314 88.6269 30.9233 93.1888 29.6114 97.7266C28.562 101.357 30.1253 104.925 31.0381 106.255C30.9922 101.029 33.4109 99.3939 34.221 99.2845C38.2713 98.7375 36.8872 102.74 35.9899 108.312C35.2722 112.77 38.7668 116.659 40.6038 118.046C38.9862 109.325 42.6003 104.326 45.0793 104.359C50.5881 104.433 46.289 111.282 43.4464 114.664Z'
          fill='none'
          stroke='#87C12F'
          strokeWidth='2'
        />

        {/* Petal 2 */}
        <path
          d='M57.8841 140.797C61.7205 144.283 55.225 154.4 53.0886 159.019L53.575 159.35C61.825 149.45 67.8747 150.424 69.8728 150.304C80.423 149.671 82.128 145.815 81.8616 144.362C80.2631 139.213 71.4713 143.042 67.4751 145.947C72.5903 137.707 77.5989 134.855 79.4639 134.459C84.1262 133.403 92.8114 130.26 90.2538 126.14C87.6962 122.02 80.3963 126.536 77.0661 129.309C76.6379 125.612 81.462 118.434 86.6571 117.029C95.4489 114.652 96.1435 112.936 95.4489 111.483C93.8504 107.046 85.1918 110.163 81.0624 112.275C87.19 107.918 95.0493 98.8068 89.8541 95.6378C83.9103 92.012 78.931 104.749 78.265 111.087C77.5989 106.73 75.2278 98.3315 71.0717 99.5991C65.8766 101.184 71.871 107.126 74.6683 113.464C76.9062 118.534 75.3344 124.027 74.2687 126.14C73.3096 118.534 69.4732 116.633 68.2743 116.633C62.2799 116.633 65.0773 122.179 67.4751 130.102C69.3933 136.44 65.0773 142.778 62.6795 145.155C63.3189 132.161 57.0848 125.605 53.488 126.14C45.4956 127.329 53.0885 136.44 57.8841 140.797Z'
          fill='none'
          stroke='#87C12F'
          strokeWidth='2'
        />

        {/* Stem */}
        <path
          d='M48.0904 122.522C47.9967 120.392 47.9371 118.314 47.9085 116.289L47.8952 115.106C47.7211 94.1447 52.681 65.4952 55.4532 58.2874C55.5524 58.0297 55.8417 57.9011 56.0994 58.0003C56.3571 58.0994 56.4857 58.3887 56.3866 58.6464C53.6334 65.8046 48.6325 94.6498 48.9046 115.994C48.9279 117.82 48.9764 119.689 49.0527 121.602L49.1022 122.765C49.8119 138.415 52.3747 156.854 58.0812 177.366C58.1552 177.632 57.9995 177.908 57.7335 177.982C57.4675 178.056 57.1918 177.9 57.1178 177.634C51.3555 156.921 48.7849 138.308 48.0904 122.522Z'
          fill='none'
          stroke='#87C12F'
          strokeWidth='2'
          strokeLinecap='round'
        />

        {/* Flower Shape */}
        <path
          d='M58.1022 4.5C73.0146 4.5 62.5146 30.5 62.5146 30.5C62.5146 30.5 71.2464 5.40563 83.0239 12.9746C94.8015 20.5436 69.0605 40.5045 69.0605 40.5045C69.0605 40.5045 100.524 12.9746 103.584 29.2292C109.024 47.9364 77.0146 43 77.0146 43C77.0146 43 109.586 43.2582 107.593 57.1157C105.601 70.9733 71.2918 56.0235 71.2918 56.0235C71.2918 56.0235 105.058 72.1625 95.8896 82.743C86.7216 93.3235 65.9415 62.1982 65.9415 62.1982C65.9415 62.1982 87.4475 94.5557 74.0146 98.5C60.5817 102.444 60.825 70 60.825 70C60.825 70 62.9414 101.5 39.5146 93C26.0817 89.0557 50.2629 62.1982 50.2629 62.1982C50.2629 62.1982 31.6827 87.5805 22.5146 77C13.3466 66.4195 33.0146 58.5 33.0146 58.5C33.0146 58.5 14.613 67.8575 12.6206 54C12.6206 37.5 39.5146 47.9364 39.5146 47.9364C39.5146 47.9364 6.80476 41.9641 12.6206 29.2292C20.0438 12.9746 47.0146 38 47.0146 38C47.0146 38 15.0146 14.5 31.0701 7.93732C47.0146 -3 54.017 36.0874 54.017 36.0874C54.017 36.0874 44.1022 4.5 58.1022 4.5Z'
          fill='none'
          stroke='#E2B6FF'
          strokeWidth='2'
        />

        {/* Center circle */}
        <circle
          cx='59.0146'
          cy='49'
          r='13'
          fill='none'
          stroke='#FACF71'
          strokeWidth='2'
        />
      </svg>

      {/* Background Circle (scales up behind) */}
      <div className='absolute inset-0 flex items-center justify-center z-20 pointer-events-none'>
        <svg
          ref={svg2Ref}
          width='276'
          height='276'
          viewBox='0 0 276 276'
          fill='none'
          xmlns='http://www.w3.org/2000/svg'
          className='w-96 h-96'
        >
          <path
            ref={circleRef}
            d='M129.345 3.58105C134.383 -0.527263 141.616 -0.527135 146.654 3.58105L157.915 12.7637C161.584 15.7545 166.469 16.7964 171.037 15.5615L185.027 11.7812C191.295 10.0875 197.89 13.0267 200.82 18.8193L207.431 31.8896C209.561 36.1002 213.584 39.0313 218.245 39.7695L232.622 42.0469C239.013 43.0593 243.824 48.4076 244.155 54.8691L244.912 69.6143C245.153 74.3078 247.626 78.6026 251.564 81.1689L263.865 89.1855C269.269 92.7081 271.482 99.5252 269.176 105.55L263.884 119.377C262.207 123.756 262.723 128.672 265.27 132.608L273.304 145.021C276.805 150.434 276.057 157.554 271.507 162.122L261.103 172.566C257.79 175.891 256.265 180.597 257 185.232L259.314 199.849C260.324 206.228 256.737 212.444 250.709 214.767L237.068 220.018C232.673 221.71 229.356 225.405 228.146 229.957L224.369 244.175C222.705 250.44 216.876 254.678 210.402 254.332L195.911 253.558C191.19 253.305 186.636 255.338 183.674 259.021L174.535 270.387C170.462 275.451 163.391 276.956 157.607 273.987L144.711 267.367C140.498 265.206 135.502 265.206 131.289 267.367L118.392 273.987C112.61 276.956 105.537 275.451 101.465 270.387L92.3262 259.021C89.3639 255.338 84.8097 253.305 80.0889 253.558L65.5977 254.332C59.1243 254.678 53.2951 250.44 51.6309 244.175L47.8535 229.957C46.6444 225.405 43.3266 221.71 38.9316 220.018L25.291 214.767C19.262 212.444 15.6753 206.227 16.6855 199.849L19 185.232C19.734 180.597 18.2096 175.891 14.8975 172.566L4.49219 162.122C-0.0575218 157.554 -0.804791 150.434 2.69727 145.021L10.7295 132.608C13.277 128.672 13.7922 123.756 12.1162 119.377L6.82324 105.55C4.5174 99.5252 6.73083 92.7081 12.1357 89.1855L24.4365 81.1689C28.3741 78.6026 30.8461 74.3076 31.0869 69.6143L31.8438 54.8691C32.1754 48.4077 36.9855 43.0594 43.377 42.0469L57.7549 39.7695C62.4158 39.0313 66.4385 36.1002 68.5684 31.8896L75.1797 18.8193C78.1097 13.0266 84.7058 10.0874 90.9736 11.7812L104.963 15.5615C109.532 16.7962 114.416 15.7546 118.084 12.7637L129.345 3.58105Z'
            stroke='#FACF71'
            strokeWidth='2'
          />
        </svg>
      </div>
    </div>
  );
}
